
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Seeking Simplicity</title>
  <meta name="author" content="Matt Stine">

  
  <meta name="description" content="So you&#8217;ve just installed the handy dandy Spring Security plugin (http://grails.org/plugin/acegi), which makes it incredibly easy to secure &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mattstine.com/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Seeking Simplicity" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8534802-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Seeking Simplicity</a></h1>
  
    <h2>A blog about DevOps, clouds, architecture, and everything else...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mattstine.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/11/10/securing-grails-plugin-artifacts-with-filters/">Securing Grails Plugin Artifacts With Filters</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-10T13:50:11-06:00" pubdate data-updated="true">Nov 10<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So you&#8217;ve just installed the handy dandy Spring Security plugin (http://grails.org/plugin/acegi), which makes it incredibly easy to secure entire Grails controllers and/or controller actions with annotations, such as the following:</p>

<p>This is enabled by turning on controller annotations in your SecurityConfig.groovy file:</p>

<p>So all is now good in our project. We can secure either controllers or actions with annotations, enabling us to declaratively setup security side-by-side with the code that we&#8217;re securing in a very straightforward manner. You can continue developing your Grails applications with glee, fully assured that security is no longer an issue. But wait, one day you decide to install one of the many useful Grails plugins that add controller artifacts to your application. Lo and behold, you have no way to secure those controllers! Of course, you could descend into $USER_HOME/.grails/$GRAILS_VERSION/projects/projectName/plugins/pluginX and hack the source code for your individual instance of the plugin. This ought to work, but you&#8217;re now rather constrained in that every time you update the plugin you&#8217;ll need to remember to go make this manual change. That doesn&#8217;t sound very agile at all, does it? OK, so how about forking the plugin? This is a little bit better, but now you have the burden of merging changes from the global plugin repository to yours every time a new release happens. This is better, but still a bit cumbersome. How about becoming a committer and adding it to the global source? Of course not. Not everyone will want to secure their plugins the same way you do, and you&#8217;ve just introduced a rather unnecessary dependency on the Spring Security plugin. I say all this in an attempt to paint a grim picture. In reality, we&#8217;re actually in very good shape. Grails Filters to the rescue!</p>

<p>All that you need to do is create a Grails filter that will match requests to the plugin artifact in question and then delegate to Spring Security for authorization. If they are authorized, you simply return true. If not, you can direct them to your login screen. It&#8217;s this simple:</p>

<p>As you can see here, I&#8217;ve secured both the Blurb plugin and the Settings plugin in this manner by requiring that the logged in user be in the ROLE_ADMIN role. Now as Glen Smith would say, that&#8217;s a snack!</p>

<p><em><strong>Update:</strong> <a href="http://burtbeckwith.com/blog/">Burt Beckwith</a> enlightened me to an approach that will get this done without the use of filters that will also direct you to the requested URL after login rather than the main page. Unfortunately I&#8217;ve never been able to track this down before. Just add the following to SecurityConfig.groovy:</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/11/04/pomodoro-the-first-iteration/">Pomodoro: The First Iteration</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-04T15:44:32-06:00" pubdate data-updated="true">Nov 4<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I spent about an hour last night reading through Francesco Cirillo&#8217;s e-book <em>The Pomodoro Technique</em>. Up until this point I knew the basics of the technique, but I really wanted to drill down and get the details. I won&#8217;t explain those here - visit <a href="http://www.pomodorotechnique.com/">http://www.pomodorotechnique.com/</a> to get the lowdown. What I want to talk about is my experience applying the technique this morning.</p>

<p>I managed to complete two Pomodoros. Each of the Pomodoros was filled with internal interruptions of various kinds. One of the first things that I observed was something that I already knew from yesterday&#8217;s TADD post: I am definitely not used to focusing on one distinct task for any prolonged length of time. My mind was constantly bouncing around from idea to idea, almost as if my R-mode had a &#8220;memory leak.&#8221; My first Pomodoro was primarily a reading task - I used it for my daily Bible reading and meditation. This part of my day brings it&#8217;s focus challenges anyway, as I&#8217;m not doing anything tactile. I find its much easier to focus when I&#8217;m typing or writing something. The Pomodoro offered no relief from this, save a plan for dealing with the interruptions as they came up. First, note down that one happened with an apostrophe, and second, write the todo item or idea down on my inventory. This definitely helped to refocus my mind on the work at hand, but I still wish I could find a way to prevent those streamer thoughts from landing in the first place.</p>

<p>The second thing that I observed was that my workspace is not at all setup to encourage focus. In recent months I&#8217;ve stopped using task-focused desktops in OS X, something that Neil Ford recommends in <em>The Productive Programmer</em>. I was reminded of this later in the day today reading <a href="http://memeagora.blogspot.com/2009/11/productivity-pron.html">his latest blog entry</a>. I think it would be a good idea to use my first Pomodoro of the day to setup task-based desktops for each of the tasks on my TODO list. I could fire up all of the programs necessary and drop them on to a space. Since a lot of my work is focused on web-based applications, I think I&#8217;ll probably use Fluid (<a href="http://fluidapp.com/">http://fluidapp.com/</a>) to create site specific browsers for the web applications that I need for each task. Another thing that I need to do is turn off the ringer on my phones and the new message notifications on Entourage. One tool that I did already have in my arsenal is Doodim, which blacks out everything except for the currently focused window on OS X. The only problem with Doodim (<a href="http://www.lachoseinteractive.net/en/products/doodim/">http://www.lachoseinteractive.net/en/products/doodim/</a>) is that it doesn&#8217;t work with external screens, so only my MacBook Pro&#8217;s screen gets the benefits. I counteracted this by making sure that the window I was actively using was on the external screen and maximized, but this won&#8217;t work for some tasks during which I might have multiple small windows to interact with.</p>

<p>The final thing that I observed is that I still definitely live in an interruption-based work environment. My third attempt to complete a Pomodoro was repeated three times, and none of these times did I make it without having to stop and actively handle an external interruption. The difference? My office door was open. My first two Pomodoros were completed with the office door closed and my &#8220;Ssshhh&#8230;Genius at work!&#8221; sign on the door. This is going to be a tough one to handle. I don&#8217;t want to keep my office door closed all day, for more reasons than one. First, I don&#8217;t want to seem completely unapproachable. I&#8217;m a manager these days, and a huge part of my job is being available for people. For me, some interruptions will always be OK. But how can I sort those out prior to them happening? This is something I&#8217;ll be stewing on over the next couple of days. Second, my office turns into an absolute OVEN when the door is closed for too long. We have a really strange HVAC system that completely overreacts to small changes in the temperature. Unfortunately, it always seems to think I need to be slow cooked. ::SIGH::</p>

<p>So, there you have it. I&#8217;ve learned a lot - I observed quite a view things about my work patterns and my environment, and will be working over the next few days to make changes to both to support better focus. If you have any comments or suggestions, please feel free to comment. Thanks!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/11/03/hi-im-matt-stine-and-i-have-technology-add/">Hi, I&#8217;m Matt Stine, and I Have Technology ADD&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-03T16:50:16-06:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yes, it&#8217;s true. I came to the realization that there is such a thing as TADD&#8230;technology attention deficit disorder. Ironically, I came to this realization while reading a sample chapter from the upcoming book from the Prags, <em>Pomodoro Technique Illustrated: Can You Focus - Really Focus - for 25 Minutes?</em> You see, it&#8217;s Pragmatic Programmer Writing Month (<a href="http://praglife.typepad.com/pragmatic_life/2009/10/prag-pro-wri-mo.html">follow the trail that begins here</a>), and I finally set aside an hour today to begin writing. At present, I just can&#8217;t make up my mind what book topic I want to focus on. I have the following in mind:</p>

<ul>
<li><p>Polyglot Programming</p></li>
<li><p>Agile Testing Strategies</p></li>
<li><p>Groovy/Grails Automated Testing</p></li>
<li><p>Functional Programming in a JVM World</p></li>
<li><p>Or, perhaps, a topic that hasn&#8217;t churned up from my R-mode brain yet&#8230;</p></li>
</ul>


<p>So, I have decided that I want to write an article detailing my development of <a href="http://www.duckduckgoosedesigns.com">http://www.duckduckgoosedesigns.com</a> in Grails, an article that I hope will appear in an upcoming issue of Groovymag. It seemed like a good idea - write on something that I know very well and that I think could be helpful to others. Not only that, but it just might prime the writing pump for a bigger work like, maybe, a book! So, as I started writing, it occurred to me that I needed to let WebDevPub know that the entire source code for the online store was available at GitHub, so I jumped into the article submission site and added a note. This reminded me that I had not yet applied license headers to my source files, so I jumped into IDEA to use the Copyright Plugin to do so. It was at this point that I figured out that the Copyright Plugin does not support Groovy or GSP files, so I decided it would be a good idea to write a Grails script that would automatically do this. In the process, I decided to jump over to TweetDeck and let the world know of my intentions. It was at this point that I realized I had not yet followed @praglife on Twitter, so I fired that off. Realizing I wasn&#8217;t quite sure of the @praglife Twitter handle, I jumped over to the blog, and while looking for it noticed the news item about the Pomodoro book. I clicked on it and downloaded the sample chapter on interruptions. While scanning through and reading about internal interruptions, I realized that I was in the middle of one. My simple task - to focus on writing an article, had been interrupted by a stream of internal interruptions that led me to reading about internal interruptions. I have TADD. I&#8217;m out of denial, so what&#8217;s the next step? ;-)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/10/21/thoughts-so-far-on-springone2gx/">Thoughts So Far on #springone2gx</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-21T22:00:01-05:00" pubdate data-updated="true">Oct 21<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&#8217;s now Wednesday night, day 2.5 of SpringOne/2GX in New Orleans, LA. Normally I like to blog about each session that I attend when I make it to SpringOne, but as this has been my first year here as a speaker, I&#8217;ve spent practically all of my free time tweaking my presentation and demos. So, I wanted to summarize my reflections thus far before I forget them.</p>

<p>First of all, my talk went off fantastically. I presented <a href="http://www.springone2gx.com/conference/new_orleans/2009/10/session?id=15651">Case Study: SRM 2.0 - A next generation shared resource management system built on SpringSource dm Server</a>, which summarized our experiences using OSGi and SpringSource dm Server as the foundation for the enterprise application that we&#8217;re about to release into production. There was a small but very enthusiastic crowd, and I fielded quite a few questions both during the talk and immediately following. I was very encouraged to see nothing but green in the evaluation bucket at the back of the room, and <a href="http://twitter.com/sudr/status/5056103019">this tweet</a> was the icing on the cake.</p>

<p>Second, I&#8217;ve been extremely impressed with the venue. After attending the last two years in Hollywood, Florida, I can&#8217;t help but think that this move was one of the best that was made. The Roosevelt Hotel is very charming, and the banquet staff here is top notch. I&#8217;ve attended quite a few conferences, and the food here is definitely some of the best I&#8217;ve ever had. Not only that, but there is an entirely different energy level here in New Orleans - just hearing the live jazz piping into my hotel room every night from the French Quarter below is very nice.</p>

<p>Third, the combination of SpringOne and 2GX, the Groovy and Grails conference, into one event has topped my expectations. Being able to bounce back and forth between two of my favorite technologies has been awesome. Getting the latest scoop on Spring 3.0 and diving into Griffon during the same morning was great. Not only that, but getting to interact with my tweeps from SpringSource and the G3 community during the same week has been a blast. My only regret is that I didn&#8217;t have my talk more finalized before the event so that I could spend more time with the hallway conversations.</p>

<p><strong>Quick reviews of the sessions that I&#8217;ve attended thus far:</strong></p>

<ul>
<li><p>What&#8217;s New in Spring 3.0 (Arjen Poutsma) - This was a great overview of the new and notable in Spring 3.0. I was very excited to see just how simple and powerful the REST support that is now built directly into Spring MVC will be. The only letdown was that Arjen didn&#8217;t dye his hair this year.</p></li>
<li><p>Intro to Griffon: Grails for RIAs (Danno Ferrin) - This was my first opportunity to hear a full blown talk on Griffon. Danno did a fantastic job walking us through how to use Griffon to develop a simple weather dashboard widget. I absolutely can&#8217;t wait to write my first Griffon app. Now that my session is done, I may start tonight!</p></li>
<li><p>Grails Internals (Jeff Brown) - Jeff Brown is live coding at its best. I love his ZERO slides approach, and I learned quite a bit about the different metaprogramming aspects used to deliver Grails functionality. I&#8217;m more than inspired to contribute to plugins at a higher level now.</p></li>
<li><p>MOPing up Groovy (Venkat Subramaniam) - Whether you&#8217;re interested in the topic or not, one must attend AT LEAST one Venkat talk whenever he&#8217;s in the same town as you. This talk was mostly focused around the metaprogramming topics that Venkat covered in <em>Programming Groovy</em>, but seasoned with Venkat&#8217;s unique blend of off the cuff humor. From no one else will you hear, &#8220;We don&#8217;t want to duplicate code&#8230;at least not in public.&#8221;</p></li>
<li><p>Grails for the Enterprise (Robert Fischer) - I must admit, I didn&#8217;t really NEED to go to this talk. I was mainly interested in checking out Robert as a speaker and hearing his strategies for driving Grails adoption. I liked his approach, and I really enjoyed his live coding session at the back end of the talk. He has quite a bit of energy and created a very rich interaction with the crowd.</p></li>
<li><p>Functional Groovy (Hamlet D&#8217;Arcy) - This was by far the best session of the conference for me thus far. Hamlet walked us through the 10 commandments of functional programming using Groovy as the syntax for exploration, sprinkled in a healthy amount of <em>The Little Schemer</em>, explained that using a non-functional language to learn functional programming was like learning OO in Cobol, and found a way to tie in <em>Zen and the Art of Motorcycle Maintenance</em>, Plato, Aristotle, elephants, and ducks.</p></li>
<li><p>What&#8217;s new in dm Server 2.0 (Ben Hale) - Ben walked us through the new and notable in dm Server 2.0. A great app server has gotten even better!</p></li>
</ul>


<p>So there you have it. I&#8217;m looking forward to a nice relaxing day tomorrow (now that I don&#8217;t have demos and slides to tweak all day) and a quick flight home to rejoin my wife and kids. See you tomorrow Grant and the girls!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/10/09/making-java-groovier-with-lambdaj/">Making Java &#8220;Groovier&#8221; With LambdaJ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-09T09:37:06-05:00" pubdate data-updated="true">Oct 9<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I spent the better part of yesterday tracing my way through the codebase for a large-scale enterprise application that my team is building right now, and I happened upon the following piece of code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">//...imports excluded for clarity</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BusinessActivityBinMetaClassHelper</span> <span class="o">{</span>
</span><span class='line'><span class="c1">//...</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">getSrmMetaClassIdListJava</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">BusinessActivityBinMetaClass</span><span class="o">&gt;</span> <span class="n">businessActivityBinMetaClassList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">srmMetaClassIdList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">?();</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="o">(</span><span class="n">businessActivityBinMetaClassList</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>         <span class="k">for</span><span class="o">(</span><span class="n">BusinessActivityBinMetaClass</span> <span class="n">businessActivityBinMetaClass</span> <span class="o">:</span> <span class="n">businessActivityBinMetaClassList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>             <span class="k">if</span><span class="o">(</span><span class="n">businessActivityBinMetaClass</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">businessActivityBinMetaClass</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">().</span><span class="na">getSrmMetaClassId</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>               <span class="n">srmMetaClassIdList</span><span class="o">.</span><span class="na">add</span>
</span><span class='line'>                  <span class="o">(</span><span class="n">businessActivityBinMetaClass</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">().</span><span class="na">getSrmMetaClassId</span><span class="o">());</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>         <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="n">srmMetaClassIdList</span><span class="o">;</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="c1">//...</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>As I read this code, I thought &#8220;This just SCREAMS a need for Groovy&#8217;s closure iterators.&#8221; So, last night I quickly hacked out fully-equivalent Groovy version of the code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">class</span> <span class="nc">GroovyExample</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>   <span class="kd">static</span> <span class="n">def</span> <span class="nf">getSrmMetaClassIdListGroovy</span><span class="o">(</span><span class="n">def</span> <span class="n">businessActivityBinMetaClassList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">businessActivityBinMetaClassList</span><span class="o">?.</span><span class="na">collect</span> <span class="o">{</span> <span class="n">it</span><span class="o">?.</span><span class="na">srmMetaClass</span><span class="o">?.</span><span class="na">srmMetaClassId</span> <span class="o">}.</span><span class="na">findAll</span> <span class="o">{</span> <span class="n">it</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">}</span> <span class="o">?:</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Whew! Much nicer. What did we get out of this? Well&#8230;</p>

<ul>
<li><p>Groovy&#8217;s dynamic typing cleaned up all of the unnecessary type declarations - the only static typing is where we return an empty ArrayList of Longs if the argument to our method is null (a bit of odd behavior, but required to make this code equivalent to the parent Java code.</p></li>
<li><p>We were saved 4 painful null checks by the use of Groovy&#8217;s null safe dereferencing operator (?.) and the simplified ternary operator otherwise affectionately known as the &#8220;Elvis Operator&#8221; (?:).</p></li>
<li><p>Using Groovy&#8217;s collect method, we were able to transform the original list into a list containing Long values by passing in a closure that pulls out the property value of interest.</p></li>
<li><p>Because we&#8217;re using null safe dereferencing, we are actually inserting nulls into our list if any of the dereferencing fails. Therefore, Groovy&#8217;s findAll Collection filtering method comes to the rescue. We simply provide it with a closure that returns true for all of the values we want to keep - in this case, &#8220;it != null.&#8221;</p></li>
<li><p>Perhaps most importantly, we&#8217;ve shorted our code from 11 lines (including whitespace lines for clarity) to ONE LINE that much more clearly expresses the intent of the code.</p></li>
</ul>


<p>Great - why don&#8217;t we just rewrite the entire application is Groovy? Well, hold on just a minute. At the time we started this application, as much as some of us loved Groovy, we just didn&#8217;t have enough Groovy mindshare to go there yet. On top of that, we were already experimenting with several new architectural ideas and technologies, and Groovy would have added yet one more risk to the puzzle. I say all this to acknowledge that sometimes you just can&#8217;t move to another language for one reason or another, regardless of how attractive its features may be.</p>

<p>But let&#8217;s take a queue from the <em>Pragmatic Programmer</em> and explore the LOTY (Language of the Year) concept one more time. One of the reasons that you&#8217;re encouraged to learn new languages is to change the way you program in your main language. You may learn Groovy, Scala, Clojure, Ruby, etc., etc., etc. and never use them in your day job - and yet the experience of coding in a new language with new constructs and idioms will necessarily change the way you THINK about programming in every other language.</p>

<p>So, let&#8217;s think about the possibility of coding something that is much more similar to the Groovy version and yet stick with regular Java code. Fortunately, there are several libraries out there that bring much of the flavor and power of Groovy&#8217;s closure iterators to Java. I&#8217;d like to focus in on one of them, LambdaJ (<a href="http://code.google.com/p/lambdaj/">http://code.google.com/p/lambdaj/</a>).</p>

<p>LambdaJ provides constructs that allow us to &#8220;&#8230;manipulate collections in a pseudo-functional and statically typed way.&#8221; Let&#8217;s take a look at this example implementing using LambdaJ:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">//...some imports excluded for clarity</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">ch.lambdaj.function.convert.Converter</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">static</span> <span class="n">ch</span><span class="o">.</span><span class="na">lambdaj</span><span class="o">.</span><span class="na">Lambda</span><span class="o">.*</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">Matchers</span><span class="o">.*</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BusinessActivityBinMetaClassHelper</span> <span class="o">{</span>
</span><span class='line'><span class="c1">//...</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">getSrmMetaClassIdListJava</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">BusinessActivityBinMetaClass</span><span class="o">&gt;</span> <span class="n">businessActivityBinMetaClassList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="o">(</span><span class="n">businessActivityBinMetaClassList</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">filter</span><span class="o">(</span><span class="n">notNullValue</span><span class="o">(),</span><span class="n">convert</span><span class="o">(</span><span class="n">businessActivityBinMetaClassList</span><span class="o">,</span> <span class="k">new</span> <span class="n">IdExtractor</span><span class="o">()))</span> <span class="o">:</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="kd">class</span> <span class="nc">IdExtractor</span> <span class="kd">implements</span> <span class="n">Converter</span><span class="o">&lt;</span><span class="n">BusinessActivityBinMetaClass</span><span class="o">,</span><span class="n">Long</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">Long</span> <span class="nf">convert</span><span class="o">(</span><span class="n">BusinessActivityBinMetaClass</span> <span class="n">from</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>     <span class="k">if</span> <span class="o">(</span><span class="n">from</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">from</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">().</span><span class="na">getSrmMetaClassId</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">from</span><span class="o">.</span><span class="na">getSrmMetaClass</span><span class="o">().</span><span class="na">getSrmMetaClassId</span><span class="o">();</span>
</span><span class='line'>     <span class="o">}</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Not quite as nice as the Groovy code - we got A LOT out of the null-safe dereference and Elvis operators. However, our overall intent is still a bit clearer. Let&#8217;s analyze:</p>

<ul>
<li><p>First we need to implement one of LambdaJ&#8217;s Converters. A Converter is nothing more than a generic Interface that defines one method: T convert(F from), where F is the type we&#8217;re converting from and T is the type we&#8217;re converting to. In this case, we want to convert an object of type BusinessActivityBinMetaClass to an object of type Long. Our implementation determines how this conversion takes place, in this case by extracting the id property from its child.</p></li>
<li><p>Next, after statically importing the methods of ch.lambdaj.Lambda, we call the convert method, passing it our List and our newly implemented Converter. This gives us the equivalent of Groovy&#8217;s collect method, with the Converter taking the place of the closure.</p></li>
<li><p>We&#8217;re still shoving nulls into our List with this implementation, so we further filter our list using LambdaJ&#8217;s &#8220;filter&#8221; method, passing it the list returned by &#8220;filter,&#8221; and a <a href="http://code.google.com/p/hamcrest/">Hamcrest</a> matcher that returns only notNullValue()&#8217;s.</p></li>
<li><p>Finally, we use our old friend the ternary operator to return the empty ArrayList of Long values if our method argument is null.</p></li>
</ul>


<p>If you don&#8217;t count the Converter implementation, we&#8217;ve gotten ourselves down to 2 lines of code (1 if you don&#8217;t mind long lines). In this case I implemented IdExtractor as a named inner class - you could do this with an anonymous inner class and it would look a lot more like a closure, but the added noise of all of the null checking made the undesirable for me. Perhaps if your code has less noise (or guarantees that values aren&#8217;t null), that would be a better approach.</p>

<p>Another alternative is to make IdExtractor a top-level class that, if general enough, could be reused throughout the codebase. The benefit of this is that you now have a nice code unit rather than a battery of static methods in a utility class, and unit testing becomes much more clean and elegant.</p>

<p>So, we&#8217;ve still made some progress and made our code a bit more Groovy. I encourage you to explore LambdaJ&#8217;s feature set and see how it might make your code a bit more concise with clearer intent. And just to stir up a little controversy, look what would have happened in Java 7 had the null safe dereference and Elvis operator&#8217;s made <a href="http://blogs.sun.com/darcy/entry/project_coin_final_five">the Project Coin cut</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">//...some imports excluded for clarity</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">ch.lambdaj.function.convert.Converter</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">static</span> <span class="n">ch</span><span class="o">.</span><span class="na">lambdaj</span><span class="o">.</span><span class="na">Lambda</span><span class="o">.*</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">Matchers</span><span class="o">.*</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BusinessActivityBinMetaClassHelper</span> <span class="o">{</span>
</span><span class='line'><span class="c1">//...</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">getSrmMetaClassIdListLambdaJ</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">BusinessActivityBinMetaClass</span><span class="o">&gt;</span> <span class="n">businessActivityBinMetaClassList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nf">filter</span><span class="o">(</span><span class="n">notNullValue</span><span class="o">(),</span><span class="n">convert</span><span class="o">(</span><span class="n">businessActivityBinMetaClassList</span><span class="o">,</span>
</span><span class='line'>         <span class="k">new</span> <span class="n">Converter</span><span class="o">&lt;</span><span class="n">BusinessActivityBinMetaClass</span><span class="o">,</span><span class="n">Long</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">Long</span> <span class="nf">apply</span><span class="o">(</span><span class="n">BusinessActivityBinMetaClass</span> <span class="n">from</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">from</span><span class="o">?.</span><span class="na">getSrmMetaClass</span><span class="o">()?.</span><span class="na">getSrmMetaClassId</span><span class="o">()}</span>
</span><span class='line'>         <span class="o">}))</span> <span class="o">?:</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nice, huh? ;-)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/10/03/test-driven-development-worked-for-me/">Test Driven Development Worked for Me!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-03T17:02:36-05:00" pubdate data-updated="true">Oct 3<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Our team got to spend a few days with Jared Richardson this week, talking tech leadership, agile, and automated testing. At some point during the opening day&#8217;s discussion, I related the story of how I initially got into Test Driven Development (TDD) and how it seriously ramped up my productivity and decreased my defect count.</p>

<p>In early 2003, we were slowly dragging through development of the first version of our Shared Resource Management system. At the time our development model looked a little something like this:</p>

<p>1) Code until you run into an unimplemented dependency;
2) Repeat until one of the dependencies is checked in;
3) Big Bang Integration!
4) Debug, debug, debug&#8230;
5) Repeat until something pseudo-demoable is ready.</p>

<p>As you might imagine, this wasn&#8217;t a very productive way to work, but unfortunately it was all most of us knew. At the time I thought we really needed to improve on our testing so that we could eliminate a lot of the defects that at the time I didn&#8217;t realize were being caused by our development model. I asked my boss if I could start a QA effort and not too much later found the XP/Agile Universe conference that was held in August 2003. It was my hope that we could learn about how to properly test/QA our software there as there seemed to be a lot of talks about this &#8220;TDD&#8221; thing. I got approval to attend, and while down there I was immersed in this new culture of Extreme Programming (XP) and Agile.</p>

<p>At one point I ventured into a room that was setup like what many of us would call a SCRUM/Team room today, where a group of folks were all coding away on a system and making its &#8220;Fit&#8221; tests pass. I quickly paired up with a gentleman and we went to work. At some point Brian Marick came over and asked what we were working on. I fumbled through a description of the requirement and he then asked, &#8220;Well, where&#8217;s your test?&#8221; I said that we didn&#8217;t have one, and he then said something that at the time was very profound to me, &#8220;Well, you can&#8217;t write any code until you have a failing test!&#8221;</p>

<p>I spent most of my time waiting in the airport to return to Memphis reading Uncle Bob&#8217;s &#8220;Agile Software Development: Principles, Patterns, and Practices.&#8221; Needless to say, I was fired up.</p>

<p>When I returned to work in the following weeks, I essentially tried two different tactics in parallel to share what I learned with my team.</p>

<p>First, I practiced what Jared calls &#8220;2x4 Development,&#8221; or, beating your team in the shins with a 2x4 until they start doing TDD, pair programming, continuous integration, etc. I even delivered my own version of the agile manifesto to the entire department, and the most profound comments I got out of that were &#8220;I can&#8217;t ever imagine us paying two developers to sit at the same computer and work on the same code,&#8221; and &#8220;Well, who&#8217;s going to test the test code?!?!&#8221;</p>

<p>Needless to say, this didn&#8217;t work very well. My second tactic was much more guerrilla in nature. I told the guy that I was working with that I didn&#8217;t care what he did with the rest of his time, as long as he checked in his interfaces before he started to code. Now I had something to mock! I then proceeded to TDD all of my code. I advertised my productivity in terms of test cases passing with a little counter on my whiteboard. Development was fun again, as I could get instant feedback on how my code was working and I knew that it was interacting properly with its dependencies. Sure enough, when those big bang integrations happened, my code rarely seemed to be the source of the defects, and I quickly found myself getting pulled into other parts of the code to help develop since I had already gotten my typical assignment finished!</p>

<p>We delivered the section of the system that I developed using TDD much faster than any part that I had worked on up to that point (no hard numbers, but I have a pretty good memory of that time), and in addition, I wrote the CLEANEST code I had ever written up to that point.</p>

<p>So, while Jared wouldn&#8217;t recommend you try TDD if the rest of your team isn&#8217;t on board - you&#8217;re never going to get someone who doesn&#8217;t care about tests to fix one that they broke - this guerrilla tactic worked well for me and got me some recognition as a guy who could write good clean code fast! If I could go back to that point, I think I would have tried <a href="http://www.jaredrichardson.net/blog/2005/11/03/">Defect Driven Testing</a> first or in addition to my GTDD.</p>

<p>So, how are you getting your team test infected?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/25/isabella-featured-on-totally-tots/">Isabella Featured on Totally Tots</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-25T13:10:22-05:00" pubdate data-updated="true">Jun 25<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://totallytots.blogspot.com/2009/06/meetisabella.html"><img src="http://mattstine.files.wordpress.com/2009/06/meet_bella.jpg" alt="meet_bella" /></a></p>

<p>Isabella, my second oldest daughter, just made the cutoff <a href="http://totallytots.blogspot.com/2009/06/meetisabella.html">to be featured</a> on one of the very popular &#8220;Mommy Blogs&#8221; out there, Totally Tots. Way to go Bella!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/19/javaone-brain-dump-resources-from-memphis-jug-meeting/">#JavaOne Brain Dump Resources From Memphis JUG Meeting</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-19T12:25:33-05:00" pubdate data-updated="true">Jun 19<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I promised that I would post the links I mentioned in my talk last night at the Memphis JUG&#8230;here they are:</p>

<p>General Session Replays: <a href="http://java.sun.com/javaone/2009/general_sessions.jsp">http://java.sun.com/javaone/2009/general_sessions.jsp</a></p>

<p>BlogTalkRadio: <a href="http://www.blogtalkradio.com/JavaOne">http://www.blogtalkradio.com/JavaOne</a></p>

<p>JavaOne Minute: <a href="http://channelsun.sun.com/video/channel-you/javaone+minute/23867338001">http://channelsun.sun.com/video/channel-you/javaone+minute/23867338001
</a>
Technical Sessions 2008-2009: <a href="http://developers.sun.com/learning/javaoneonline/">http://developers.sun.com/learning/javaoneonline/</a> (Must be SDN Member - FREE!)</p>

<p>The Da Vinci Machine Project: <a href="http://openjdk.java.net/projects/mlvm/">http://openjdk.java.net/projects/mlvm/
</a>
Groovy: <a href="http://groovy.codehaus.org">http://groovy.codehaus.org</a></p>

<p>Java.net Community Corner: <a href="http://wiki.java.net/bin/view/Javaone/CommunityCorner">http://wiki.java.net/bin/view/Javaone/CommunityCorner
</a>
JUGS Community: <a href="http://community.java.net/jugs/">http://community.java.net/jugs/</a></p>

<p>Scala: <a href="http://scala-lang.org">http://scala-lang.org</a></p>

<p>SpringSource: <a href="http://www.springsource.com">http://www.springsource.com</a></p>

<p>JUG-USA: <a href="https://jug-usa.dev.java.net/">https://jug-usa.dev.java.net/</a></p>

<p>OpenSolaris: <a href="http://opensolaris.org">http://opensolaris.org</a></p>

<p>Neal Ford: <a href="http://nealford.com">http://nealford.com</a> (Can download his slides here)</p>

<p>Findbugs: <a href="http://findbugs.sourceforge.net">http://findbugs.sourceforge.net</a></p>

<p>Grails: <a href="http://grails.org">http://grails.org</a></p>

<p>Grails Podcast: <a href="http://www.grailspodcast.com">http://www.grailspodcast.com</a></p>

<p>JavaFX: <a href="http://javafx.com">http://javafx.com</a></p>

<p>Griffon: <a href="http://griffon.codehaus.org">http://griffon.codehaus.org</a></p>

<p>Java Store: <a href="http://store.java.com">http://store.java.com</a></p>

<p>Jython: <a href="http://jython.org">http://jython.org</a></p>

<p>Clojure: <a href="http://clojure.org">http://clojure.org</a></p>

<p>JRuby: <a href="http://jruby.codehaus.org">http://jruby.codehaus.org</a></p>

<p>Sun Cloud: <a href="http://cloud.sun.com">http://cloud.sun.com</a></p>

<p>Project Kenai: <a href="http://kenai.com">http://kenai.com</a></p>

<p>Zembly: <a href="http://zembly.com">http://zembly.com</a></p>

<p>NetBeans: <a href="http://netbeans.org">http://netbeans.org</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/17/book-review-career-20-take-control-of-your-life/">Book Review: Career 2.0 - Take Control of Your Life</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-17T11:49:53-05:00" pubdate data-updated="true">Jun 17<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve finally published my review of the EXCELLENT book by Jared Richardson and Matthew Bass at DZone. Check it out here: <a href="http://books.dzone.com/reviews/career-20-take-control-your">http://books.dzone.com/reviews/career-20-take-control-your</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/09/javaone-2009-return-of-the-puzzlers-schlock-and-awe/">#JavaOne 2009 Return of the Puzzlers: Schlock and Awe</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-09T20:19:30-05:00" pubdate data-updated="true">Jun 9<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For several years now, Neal Gafter (Microsoft) and Joshua Block (Google), have made a habit of presenting various incarnations of this technical session, focused on what they call &#8220;Java Puzzlers.&#8221; Java Puzzlers are nothing more than short Java programs with curious behavior. It is a somewhat interactive session, with each puzzler&#8217;s code listing followed by a four possible choices (A,B,C,D) to answer the question: &#8220;What does it print?&#8221; Neal and Joshua &#8220;require&#8221; that every attendee vote for their answer. After the vote, they reveal the correct answer and how to fix the problem. At the end of each problem presentation is the most important part, which is the Java programming principle that is illuminated by the puzzler. These are important tools to carry with you as you go forth a develop your Java code.</p>

<p>The following is a listing of the problem titles that were presented:</p>

<ol>
<li><p>Life&#8217;s Persistent Questions</p></li>
<li><p>Instruments of Torture</p></li>
<li><p>Iterator Titillator</p></li>
<li><p>Searching for the One</p></li>
<li><p>Cogito Ergo Sum</p></li>
<li><p>Thread Friendly</p></li>
<li><p>When Words Collide</p></li>
</ol>


<p>I&#8217;m going to spend my time focused on the last puzzler, as it was the one for which I was ABSOLUTELY CERTAIN that I knew the correct answer. Here&#8217;s the code listing:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrintWords</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
</span><span class='line'>      <span class="n">Words</span><span class="o">.</span><span class="na">FIRST</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">Words</span><span class="o">.</span><span class="na">SECOND</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">Words</span><span class="o">.</span><span class="na">THIRD</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Words</span> <span class="o">{</span> <span class="c1">// Compile PrintWords against this version</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FIRST</span>  <span class="o">=</span> <span class="s">&quot;the&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SECOND</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">THIRD</span>  <span class="o">=</span> <span class="s">&quot;set&quot;</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Words</span> <span class="o">{</span> <span class="c1">// Run against this version</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FIRST</span>  <span class="o">=</span> <span class="s">&quot;physics&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SECOND</span> <span class="o">=</span> <span class="s">&quot;chemistry&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">THIRD</span>  <span class="o">=</span> <span class="s">&quot;biology&quot;</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So here&#8217;s the problem. We have two versions of class &#8220;Words.&#8221; We compile class &#8220;PrintWords&#8221; against the first version and we then run the class against the second version. What does it print out? I used my trusty &#8220;seasoned Java programmer&#8221; knowledge to assert that the program would print &#8220;the null set.&#8221; Why? Well, any seasoned Java programmer realizes that static final variables (or &#8220;constant variables&#8221; - what a curious concept) are inlined by the compiler. So it&#8217;s quite obvious that &#8220;the&#8221; would be inlined wherever FIRST appears, null would be inlined wherever SECOND appears, and &#8220;set&#8221; would be inlined wherever THIRD appears.</p>

<p>Imagine my frustration when Josh and Neil announced that the program would in fact print &#8220;the chemistry set.&#8221; As it turns out, null cannot be inlined! It is not a constant variable. So when we run our Java program, the JVM smartly picks up the non-null value of SECOND that is is able to find in the new version of Words.</p>

<p>Simply because this one got me, I wanted to highlight it for my readers. The &#8220;moral&#8221; of this story is that only primitives and strings can be constant, and that null is not a constant. One should use a constant field ONLY if its value will NEVER change. For final fields whose value may change, they suggest the use of an ident() method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// Returns its argument</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">ident</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">s</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// None of these fields are constant variables</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Words</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FIRST</span>  <span class="o">=</span> <span class="n">ident</span><span class="o">(</span><span class="s">&quot;the&quot;</span><span class="o">);</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SECOND</span> <span class="o">=</span> <span class="n">ident</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>The compile will not inline the call to ident.</p>

<p>Want more? Pick up a copy of Neal and Josh&#8217;s book, <em>Java Puzzlers: Traps, Pitfalls, and Corner Cases!</em></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
	<h1>Hello, World!</h1>
	<p>
		<img src="http://mattstine.files.wordpress.com/2011/05/indiamug.jpg" width="173" height="213">
	</p>
	<p>
		<a href="http://www.linkedin.com/in/mattstine"><img alt="View Matt Stine&#039;s profile on LinkedIn" src="http://www.linkedin.com/img/webpromo/btn_myprofile_160x33.gif" border="0" width="160" height="33"></a>
	</p>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/05/29/into-the-crucible/">Into the Crucible</a>
      </li>
    
      <li class="post">
        <a href="/2012/05/24/the-relaunch/">The Relaunch</a>
      </li>
    
      <li class="post">
        <a href="/2011/05/16/design-meeting-patternsantipatterns/">Design Meeting Patterns/Antipatterns</a>
      </li>
    
      <li class="post">
        <a href="/2011/01/05/selenium-conference-2011/">Selenium Conference 2011</a>
      </li>
    
      <li class="post">
        <a href="/2011/01/02/2010-in-review-the-automated-analysis/">2010 in review: the automated analysis&#8230;</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("mstine", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/mstine" class="twitter-follow-button" data-show-count="false">Follow @mstine</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matt Stine -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'seekingsimplicity';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
